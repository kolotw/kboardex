<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>å¯¦é©—é¡Œç›®åˆ†æ´¾é é¢</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; font-size: 16px; }
    input, button { font-size: 1rem; }
    input { padding: 0.5em; }
    button { padding: 0.5em 1em; margin-left: 10px; }
    .task { margin-top: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-size: 1rem; }
    .task h3 { margin-top: 0; font-size: 1.1rem; }
    .link-btn { margin-top: 5px; display: inline-block; background: #007bff; color: white; padding: 6px 12px; text-decoration: none; border-radius: 4px; font-size: 1rem; }
    .link-btn.green { background: #28a745; }
  </style>
</head>
<body>
æ‚¨å¥½ï¼Œæ­¡è¿åƒåŠ æœ¬ç ”ç©¶ã€‚</br>

æœ¬å¯¦é©—æ˜¯ç‚ºäº†è©•ä¼°ä¸€ç¨®æ–°çš„ä¸­æ–‡è¼¸å…¥æ–¹å¼ã€ŒKBoardã€(é‹æ³¨éŸ³)ï¼Œä¸¦èˆ‡ç¾æœ‰å¸¸ç”¨è¼¸å…¥æ³•ï¼ˆä¾‹å¦‚ Google Gboardï¼‰é€²è¡Œæ¯”è¼ƒã€‚</br>

Gboard æ˜¯å¤§å¤šæ•¸äººå¹³å¸¸ä½¿ç”¨çš„æ³¨éŸ³è¼¸å…¥æ³•ï¼Œæ‚¨éœ€è¦è¼¸å…¥æ¯å€‹å­—çš„æ³¨éŸ³ï¼Œå†é€ä¸€çµ„æˆå¥å­ã€‚è€Œ KBoard å‰‡æ¡ç”¨ä¸åŒçš„è¨­è¨ˆé‚è¼¯ï¼šæ‚¨åªéœ€è¦ç”¨æ‰‹æŒ‡åœ¨æ‰‹æ©Ÿè¢å¹•ä¸Šé»é¸å¹¾å€‹æ³¨éŸ³ï¼Œç³»çµ±å°±æœƒåœ¨å­¸ç¿’å¾Œç”¢ç”Ÿä¸€æ•´å¥è©±ã€‚ä¸éœ€è¦è¼¸å…¥æ¯ä¸€å€‹å­—ã€‚</br>

<p>
<p>
åœ¨å¯¦é©—ä¸­ï¼Œæˆ‘å€‘æœƒè«‹æ‚¨åˆ†åˆ¥ä½¿ç”¨ Gboard å’Œ KBoard(ä¾å­¸è™Ÿå°¾æ•¸çš„å¥‡å¶æ•¸æ±ºå®šé †åº) ä¾†è¼¸å…¥æŒ‡å®šçš„å¥å­ï¼Œä¸¦è§€å¯Ÿè¼¸å…¥çš„é€Ÿåº¦èˆ‡æº–ç¢ºåº¦ã€‚å¯¦é©—è¨­è¨ˆçš„ç›®çš„æ˜¯æ¯”è¼ƒå…©ç¨®è¼¸å…¥æ–¹å¼åœ¨ä¸­æ–‡èªå¥è¼¸å…¥ä¸Šçš„æ•ˆç‡èˆ‡ä½¿ç”¨æ„Ÿå—ã€‚</br>

å…©å€‹éµç›¤å¯¦é©—çš„ä¸­é–“æœƒè«‹æ‚¨å¡«å¯«ä¸‰æ¬¡å•å·ï¼Œå¤§ç´„ä¸€åˆ†é˜ã€‚</br>
å¦‚æœæ„Ÿè¦ºç–²ç´¯ï¼Œå¯ä»¥ä¼‘æ¯ã€‚ä½†å¸Œæœ›æ‚¨å¯ä»¥åœ¨ä¸€é€±å…§å®Œæˆæœ¬å¯¦é©—ã€‚</br>

æ‚¨åœ¨å¯¦é©—ä¸­çš„æ‰€æœ‰æ“ä½œç´€éŒ„åƒ…ç”¨æ–¼ç ”ç©¶åˆ†æï¼Œä¸æœƒè¨˜éŒ„å€‹äººèº«ä»½è³‡è¨Šï¼Œä¸¦å°‡åš´æ ¼ä¿å¯†ï¼Œåƒ…é™ç ”ç©¶åœ˜éšŠä½¿ç”¨ã€‚</br>
æ‚¨çš„åƒèˆ‡å°æˆ‘å€‘çš„ç ”ç©¶éå¸¸é‡è¦ï¼Œæ„Ÿè¬æ‚¨çš„å”åŠ©ï¼<p>

å°ˆæ¡ˆè² è²¬äººï¼šä½›å…‰å¤§å­¸ è³‡è¨Šæ‡‰ç”¨å­¸ç³»åŠ©ç†æ•™æˆ éƒ­é¾  æ•¬å•Ÿ</br></br>

<a href = "https://fgukolo.notion.site/2322dedc4f62805ebc75dd3571253c6d" target="_blank"> è©³ç´°çš„å¯¦é©—èªªæ˜åœ¨é€™è£¡</a> <p>

	<a href = "https://kolotw.github.io/kboardex/APP/KBoard.apk"> KBoard é‹æ³¨éŸ³ å®‰è£é€£çµ(ç´„15MB)</a> </br>
	Gboard ç‚ºGoogleçš„éµç›¤ï¼Œè«‹è‡ªè¡Œè‡³ Google playä¸‹è¼‰</br>
	
	<p>
<h2>å–®éŸ³æˆå¥çš„å­¸ç¿’æ–¹æ³•</h2>
å¦‚ï¼šã€Œæˆ‘æƒ³å‡ºå»ç©ã€</br>
ç¬¬1æ¬¡å­¸ç¿’ï¼šã„¨ -> æˆ‘ï¼›ã„’ãƒ¼ã„¤ -> æƒ³ ï¼›ã„”ã„¨ -> å‡º ï¼› ã„‘ -> å» ï¼› ã„¨ã„¢ -> ç©</br>
ç¬¬2æ¬¡å­¸ç¿’ï¼šã„¨ã„’ -> æˆ‘æƒ³ ï¼› ã„”ã„‘ -> å‡ºå» -> ç© æœƒè‡ªå‹•é€£çµ</br>
ç¬¬3æ¬¡å­¸ç¿’ï¼šã„¨ã„” -> æˆ‘æƒ³å‡ºå» -> ç© æœƒè‡ªå‹•é€£çµ</br>
ç¬¬4æ¬¡å­¸ç¿’ï¼šã„¨ã„¨ -> æˆ‘æƒ³å‡ºå»ç© </br>
ä¹‹å¾Œå†æ‰“ã„¨ï¼Œå°±æœƒç›´æ¥é¡¯ç¤ºã€Œæˆ‘æƒ³å‡ºå»ç©ã€çš„å¾…é¸å­—</br>
å–®éŸ³æˆå¥çš„ä¸Šé™æ˜¯6å€‹ä¸­æ–‡å­—ã€‚</br>
<p>

  <h1>è¼¸å…¥å­¸è™Ÿä»¥ç²å¾—å¯¦é©—é¡Œç›®(ä¸è¦ç”¨LINEé–‹å•Ÿï¼Œè³‡æ–™æœƒæµå¤±)</h1>
  <h3>æ³¨æ„ï¼šä¸è¦ä¸€æ°£å‘µæˆåšå®Œï¼ŒWebTEMç³»çµ±æœƒç„¡æ³•è¨˜éŒ„çµæœ(é€™ç³»çµ±ä¸æ˜¯æˆ‘èƒ½æ§åˆ¶çš„)ã€‚æ‰“å­—å¯ä»¥å¿«ï¼Œä½†ä¸‹å€‹é¡Œçµ„è¦é–“éš”ä¼‘æ¯ä¸€ä¸‹(3-5åˆ†é˜)ã€‚</h3>
  <input type="text" id="studentID" placeholder="è«‹è¼¸å…¥å­¸è™Ÿ">
  <button onclick="generateTasks()">ç”¢ç”Ÿé¡Œç›®</button>
  <div id="taskContainer"></div>
	<div style="margin-top: 30px">
	  <button onclick="resetProgress()" style="background: #dc3545; color: white; border: none; padding: 10px 15px; border-radius: 5px; font-size: 1rem;">
		ğŸ” æ¸…é™¤ç›®å‰é€²åº¦
	  </button>
	</div>


<script>
const tasks = ['G1','G2','G3','G4','G5','G6','G7','G8'];
const githubBase = 'https://kolotw.github.io/kboardex/tasks/';
const Ctask = 'G9';

async function fetchTaskText(taskID) {
  const url = `${githubBase}${taskID}.csv`;
  const res = await fetch(url);
  const text = await res.text();
  return text.split("\n").filter(line => line.trim()).slice(0, 24).join("\n");
}

const taskTextCache = {};

const webTEMLinks = {};
['K', 'G'].forEach(prefix => {
  for (let i = 1; i <= 12; i++) {
    const id = `${prefix}S${i}`;
    webTEMLinks[id] = `http://www.asarif.com/resources/WebTEM/#uo=ttf&e=kolo.tw@gmail.com&c=${prefix}board&s=${i}&p=10&kb=tf&st=fftffffff&m=ttttttttttttttttttttttttt&im=ffffffff&o=ffftffffftttffftff`;
  }
});

function getRandomElements(array, count, exclude = []) {
  const filtered = array.filter(item => !exclude.includes(item));
  const shuffled = filtered.sort(() => 0.5 - Math.random());
  return shuffled.slice(0, count);
}

async function generateTasks() {
  const id = document.getElementById('studentID').value.trim();
  if (!id || isNaN(id)) return alert('è«‹è¼¸å…¥æ­£ç¢ºå­¸è™Ÿï¼');

  const saved = localStorage.getItem('experiment_' + id);
  let config;

  if (saved) {
    config = JSON.parse(saved);
  } else {
    const isOdd = parseInt(id.slice(-1)) % 2 === 1;
    const Afirst = isOdd ? 'Kboard' : 'Gboard';
    const Bsecond = isOdd ? 'Gboard' : 'Kboard';

    let Agroup = getRandomElements(tasks, 1);
    let Bgroup = getRandomElements(tasks, 1, Agroup);
    while (Agroup[0] === Bgroup[0]) {
      Bgroup = getRandomElements(tasks, 1, Agroup);
    }

    const taskPlan = [];
    for (let i = 0; i < 5; i++) taskPlan.push(Agroup[0]);
    for (let i = 5; i < 7; i++) taskPlan.push(Bgroup[0]);
    for (let i = 7; i < 9; i++) taskPlan.push(Agroup[0]);
    for (let i = 9; i < 12; i++) taskPlan.push(Ctask);

    config = {
      Afirst,
      Bsecond,
      Agroup: Agroup[0],
      Bgroup: Bgroup[0],
      taskPlan,
      done: {}
    };
    localStorage.setItem('experiment_' + id, JSON.stringify(config));
  }

  if (!taskTextCache[Ctask]) {
    taskTextCache[Ctask] = await fetchTaskText(Ctask);
  }

  const container = document.getElementById('taskContainer');
  container.innerHTML = '';

  const boardOrder = [config.Afirst, config.Bsecond];

  for (const board of boardOrder) {
    const subtitle = document.createElement('h2');
    subtitle.textContent = `${board} æ¸¬é©—`;
    container.appendChild(subtitle);

    for (let i = 0; i < 12; i++) {
      const taskID = config.taskPlan[i];
      const taskNum = i + 1;
      const webID = (board[0] === 'K' ? 'K' : 'G') + 'S' + taskNum;
      const webTEMURL = webTEMLinks[webID];

      if (!taskTextCache[taskID]) {
        taskTextCache[taskID] = await fetchTaskText(taskID);
      }

      const taskText = taskTextCache[taskID];

      const div = document.createElement('div');
      div.className = 'task';

      const title = document.createElement('h3');
      title.textContent = `ç¬¬ ${taskNum} é¡Œï¼ˆ${board}ï¼‰`;

      const copyBtn = document.createElement('button');
      copyBtn.textContent = 'è¤‡è£½é¡Œç›®å…§å®¹';

      const checkmark = document.createElement('span');
      checkmark.textContent = ' âœ…';
      checkmark.style.color = 'green';
      checkmark.style.marginLeft = '8px';
      checkmark.style.visibility = config.done[webID] ? 'visible' : 'hidden';

      copyBtn.addEventListener('click', () => {
        navigator.clipboard.writeText(taskText).then(() => {
          checkmark.style.visibility = 'visible';
          config.done[webID] = true;
          localStorage.setItem('experiment_' + id, JSON.stringify(config));
        });
      });

      const br = document.createElement('br');
      const br2 = document.createElement('br');

      const link = document.createElement('a');
      link.href = webTEMURL;
      link.target = '_blank';
      link.className = 'link-btn';
      link.textContent = 'å‰å¾€ WebTEM æ¸¬é©—';

      div.appendChild(title);
      div.appendChild(copyBtn);
      div.appendChild(checkmark);
      div.appendChild(br);
      div.appendChild(br2);
      div.appendChild(link);

      if ([0, 4, 11].includes(i)) {
        const surveyTitle = document.createElement('p');
        surveyTitle.textContent = 'è«‹å¡«å¯«å•å·å¾Œä¼‘æ¯ä¸€ä¸‹';

        const surveyLink = document.createElement('a');
        surveyLink.href = 'https://forms.gle/zmAVXuD2QkpyfAy99';
        surveyLink.target = '_blank';
        surveyLink.className = 'link-btn green';
        surveyLink.textContent = 'å‰å¾€å•å·';

        div.appendChild(document.createElement('br'));
        div.appendChild(surveyTitle);
        div.appendChild(surveyLink);
      }

      container.appendChild(div);
    }
  }
  const finalSurvey = document.createElement('div');
finalSurvey.className = 'task';

const finalTitle = document.createElement('h3');
finalTitle.textContent = 'å¡«å¯«ç¸½çµå•å·';

const finalPara = document.createElement('p');
finalPara.textContent = 'æœ¬å•å·è«‹æ–¼å®Œæˆå…¨éƒ¨è¼¸å…¥ä»»å‹™å¾Œå¡«å¯«ï¼Œè«‹ä¾æ“šæ‚¨å°å…©ç¨®éµç›¤æ•´é«”ä½¿ç”¨ç¶“é©—é€²è¡Œè©•åƒ¹ã€‚é€™å°‡æœ‰åŠ©æ–¼æˆ‘å€‘äº†è§£ä½¿ç”¨è€…åå¥½èˆ‡ç³»çµ±å„ªåŒ–æ–¹å‘ã€‚';

const finalLink = document.createElement('a');
finalLink.href = 'https://forms.gle/5onZ82m48zaSeJL6A';
finalLink.target = '_blank';
finalLink.className = 'link-btn green';
finalLink.textContent = 'å‰å¾€ç¸½çµå•å·';

finalSurvey.appendChild(finalTitle);
finalSurvey.appendChild(finalPara);
finalSurvey.appendChild(finalLink);
container.appendChild(finalSurvey);

}
function resetProgress() {
  const id = document.getElementById('studentID').value.trim();
  if (!id) return alert('è«‹å…ˆè¼¸å…¥å­¸è™Ÿ');
  if (confirm('ç¢ºå®šè¦æ¸…é™¤ç›®å‰é€™å€‹å­¸è™Ÿçš„é€²åº¦å—ï¼Ÿæ­¤å‹•ä½œç„¡æ³•å¾©åŸ')) {
    localStorage.removeItem('experiment_' + id);
    alert('é€²åº¦å·²æ¸…é™¤ï¼Œè«‹é‡æ–°è¼‰å…¥é é¢æˆ–å†æ¬¡è¼¸å…¥å­¸è™Ÿã€‚');
    location.reload();
  }
}

</script>
</body>
</html>
